version: 1
applications:
  runtime: nodejs14.16
  env:
    variables:
      SANITY_PROJECT_ID: 1vz4sc35
      SANITY_DATASET: production
  frontend:
    appRoute: ./web
    phases:
      preBuild:
        commands:
          - npm install
      build:
        commands:
          - npm run build
    artifacts:
      baseDirectory: public
      files:
        - '**/*'
    cache:
      paths:
        - node_modules/**/*
  backend:
    appRoute: ./studio
    phases:
      preBuild:
        commands:
          - cd ./studio
          - npm install
      build:
        commands:
          - npm run build
